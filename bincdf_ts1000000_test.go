package fixed56

import "testing"

var bincdfTestCases_1000000 = []BinCDFCase{
	{
		n:   671487,
		x:   81740,
		p:   0.10500215104453339,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   671487,
		x:   479937,
		p:   0.44897837076069524,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   671487,
		x:   260408,
		p:   0.5472942428328025,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   671487,
		x:   625050,
		p:   0.5481335489335352,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   671487,
		x:   592944,
		p:   0.818098502489808,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   34326,
		x:   3554,
		p:   0.11873904797231849,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   34326,
		x:   24786,
		p:   0.5010710576206725,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   34326,
		x:   11876,
		p:   0.5122490125877226,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   34326,
		x:   33531,
		p:   0.5402649947180472,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   34326,
		x:   29176,
		p:   0.7440881244081394,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   618889,
		x:   80119,
		p:   0.2618860913355654,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   618889,
		x:   312851,
		p:   0.5517614734259535,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   618889,
		x:   248149,
		p:   0.5396278789976454,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   618889,
		x:   501786,
		p:   0.45557426833432835,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   618889,
		x:   542891,
		p:   0.8914426144413563,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   353944,
		x:   42092,
		p:   0.11854916867602958,
		cdf: 0.7550688745830532,
		s:   "+0'c14c319a8fce20/56",
	},
	{
		n:   353944,
		x:   202325,
		p:   0.47179587609692575,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   353944,
		x:   163063,
		p:   0.5207452062733783,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   353944,
		x:   341753,
		p:   0.4086900885846194,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   353944,
		x:   288442,
		p:   0.8072456182909402,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   968096,
		x:   146424,
		p:   0.11576003961569165,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   968096,
		x:   637757,
		p:   0.565880932850599,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   968096,
		x:   512298,
		p:   0.5154704290513524,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   968096,
		x:   681862,
		p:   0.40916487673113244,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   968096,
		x:   841416,
		p:   0.8546136681577384,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   84667,
		x:   12280,
		p:   0.273296733351054,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   84667,
		x:   67244,
		p:   0.45559472062201845,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   84667,
		x:   49052,
		p:   0.5668220853281501,
		cdf: 0.9999999999999146,
		s:   "+0'ffffffffffe7f8/56",
	},
	{
		n:   84667,
		x:   61773,
		p:   0.47403619342337655,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   84667,
		x:   72769,
		p:   0.8340350348755388,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   736911,
		x:   83049,
		p:   0.22182620113339765,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   736911,
		x:   458180,
		p:   0.5068279754059416,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   736911,
		x:   309812,
		p:   0.4326804987523857,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   736911,
		x:   590745,
		p:   0.45398956535685564,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   736911,
		x:   590220,
		p:   0.7439230347940539,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   341035,
		x:   37768,
		p:   0.1458096143928209,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   341035,
		x:   178931,
		p:   0.561009160154243,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   341035,
		x:   166259,
		p:   0.45354817519514057,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   341035,
		x:   255009,
		p:   0.582627224837109,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   341035,
		x:   286310,
		p:   0.7425253088108282,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   524481,
		x:   78376,
		p:   0.27693663077734054,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   524481,
		x:   502810,
		p:   0.4285743180884125,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   524481,
		x:   211430,
		p:   0.4493255015387967,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   524481,
		x:   496813,
		p:   0.5077954579334581,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   524481,
		x:   423077,
		p:   0.8169171980447082,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   942435,
		x:   170727,
		p:   0.17988010102807947,
		cdf: 0.9993624006810573,
		s:   "+0'ffd636dbc6f5e0/56",
	},
	{
		n:   942435,
		x:   586204,
		p:   0.5994651555978322,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   942435,
		x:   386670,
		p:   0.5019052587352929,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   942435,
		x:   675952,
		p:   0.5511564315067475,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   942435,
		x:   833821,
		p:   0.7305682638696522,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.1,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.1,
		cdf: 0.5021720037120555,
		s:   "+0'808e582ce8fa48/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.2,
		cdf: 0.5015957632335815,
		s:   "+0'80689476e68010/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.3,
		cdf: 0.5013638792983856,
		s:   "+0'80596218fb7538/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.4,
		cdf: 0.5012486493839209,
		s:   "+0'8051d4dc44a2e8/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.5,
		cdf: 0.5011968261481219,
		s:   "+0'804e6f692a4950/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.6,
		cdf: 0.5011943624161515,
		s:   "+0'804e4613845650/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.7,
		cdf: 0.5012478083602596,
		s:   "+0'8051c6c0195770/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.7,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.7,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.8,
		cdf: 0.5013962970652912,
		s:   "+0'805b81fa3b1e00/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.8,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000000,
		x:   1,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   100001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   200001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   300001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   400001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   500001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   600001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   700001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   800001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000000,
		x:   900001,
		p:   0.9,
		cdf: 0.5018174010596309,
		s:   "+0'80771aee1d6588/56",
	},
}

func Benchmark_Fixed_BinCDF_1000000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_1000000[i%len(bincdfTestCases_1000000)]
		bincdfResultFix = BinCDF(tc.n, From(tc.p), tc.x)
	}

	bincdfResultFix.lo++
}

func Benchmark_Float_BinCDF_1000000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_1000000[i%len(bincdfTestCases_1000000)]
		bincdfResultFlt = bincdf_(tc.n, tc.p, tc.x)
	}

	bincdfResultFlt++
}

func TestFixed_BinCDF_1000000(t *testing.T) {
	acc := accuracy{Epsilon: 1e-6}
	for i, tc := range bincdfTestCases_1000000 {
		p := From(tc.p)
		got := BinCDF(tc.n, p, tc.x)
		if ok := acc.update(got, tc.cdf); !ok {
			t.Errorf("%d: BinCDF(%v,%v,%v) => got %v|%v, want %v|%v", i, tc.n, tc.p, tc.x, got, got.Float(), From(tc.cdf), tc.cdf)
		}
	}
	t.Log(acc)
}
