package fixed56

import "testing"

var bincdfTestCases_10000000 = []BinCDFCase{
	{
		n:   1967825,
		x:   203338,
		p:   0.2483100999519666,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1967825,
		x:   1240699,
		p:   0.4446421476297646,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1967825,
		x:   763414,
		p:   0.5353398974845823,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1967825,
		x:   1883740,
		p:   0.4173877665258833,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1967825,
		x:   1660439,
		p:   0.7063565358963568,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1671945,
		x:   224508,
		p:   0.1465321786781479,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1671945,
		x:   1467234,
		p:   0.4053071939367727,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1671945,
		x:   765811,
		p:   0.5432039225844807,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1671945,
		x:   1554528,
		p:   0.4440881244081394,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1671945,
		x:   1350279,
		p:   0.7556381416461326,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   209031,
		x:   26134,
		p:   0.23962787899764534,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   209031,
		x:   149112,
		p:   0.45557426833432835,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   209031,
		x:   97898,
		p:   0.5914426144413563,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   209031,
		x:   183472,
		p:   0.4204420553039697,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   209031,
		x:   175679,
		p:   0.7193432753666928,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   5870619,
		x:   864431,
		p:   0.2614256546548761,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   5870619,
		x:   4862276,
		p:   0.5072456182909402,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   5870619,
		x:   3891066,
		p:   0.4757068754416708,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   5870619,
		x:   5071459,
		p:   0.45863565628141856,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   5870619,
		x:   4904357,
		p:   0.8154704290513525,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1266941,
		x:   132700,
		p:   0.232252663713542,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1266941,
		x:   936915,
		p:   0.5970443041321516,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1266941,
		x:   544362,
		p:   0.573296733351054,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1266941,
		x:   1043921,
		p:   0.45559472062201845,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1266941,
		x:   1056927,
		p:   0.8668220853281502,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   2828882,
		x:   476969,
		p:   0.17105414004550432,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   2828882,
		x:   2819900,
		p:   0.45339556440982265,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2828882,
		x:   1659711,
		p:   0.5296070770493188,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2828882,
		x:   2524640,
		p:   0.526995657639412,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2828882,
		x:   2265951,
		p:   0.8458253595900699,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   2841438,
		x:   526500,
		p:   0.17589108835152958,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2841438,
		x:   2762895,
		p:   0.5376323916866627,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2841438,
		x:   1177429,
		p:   0.5369228501979749,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   2841438,
		x:   2778086,
		p:   0.5536627155184745,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   2841438,
		x:   2527968,
		p:   0.7458096143928209,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   638552,
		x:   116614,
		p:   0.1630906096118164,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   638552,
		x:   459649,
		p:   0.4132377210423095,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   638552,
		x:   361532,
		p:   0.5752735252945338,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   638552,
		x:   508190,
		p:   0.4425253088108282,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   638552,
		x:   541980,
		p:   0.779126380212133,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   7798256,
		x:   929636,
		p:   0.1529760332996105,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   7798256,
		x:   4933558,
		p:   0.5489977964183214,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   7798256,
		x:   4860052,
		p:   0.45254832170458703,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   7798256,
		x:   7650767,
		p:   0.485686765458916,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   7798256,
		x:   6406553,
		p:   0.7798801010280795,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   3779591,
		x:   450484,
		p:   0.20190525873529294,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   3779591,
		x:   2080445,
		p:   0.5511564315067475,
		cdf: 0.002614755366279241,
		s:   "+0'00ab5c50c90383/56",
	},
	{
		n:   3779591,
		x:   1489813,
		p:   0.4305682638696522,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   3779591,
		x:   2855232,
		p:   0.5584158728725929,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   3779591,
		x:   3180299,
		p:   0.8192818061463948,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.1,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.1,
		cdf: 0.5006877041607976,
		s:   "+0'802d11c2e14450/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.2,
		cdf: 0.5005531734298079,
		s:   "+0'802440b5ca4020/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.3,
		cdf: 0.5007090465855096,
		s:   "+0'802e77d3e56718/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.4,
		cdf: 0.5011341239397118,
		s:   "+0'804a53713b0d60/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.5,
		cdf: 0.5017074623229085,
		s:   "+0'806fe676d60700/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.6,
		cdf: 0.5021960345117004,
		s:   "+0'808feb58689ca8/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.7,
		cdf: 0.5022985741636741,
		s:   "+0'8096a3acdc43e0/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.7,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.7,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.8,
		cdf: 0.5017703646641798,
		s:   "+0'807405ca55ab60/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.8,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   10000000,
		x:   1,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   1000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   2000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   3000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   4000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   5000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   6000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   7000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   8000001,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   10000000,
		x:   9000001,
		p:   0.9,
		cdf: 0.5008799973317848,
		s:   "+0'8039abe7c2b590/56",
	},
}

func Benchmark_Fixed_BinCDF_10000000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_10000000[i%len(bincdfTestCases_10000000)]
		bincdfResultFix = BinCDF(tc.n, From(tc.p), tc.x)
	}

	bincdfResultFix.lo++
}

func Benchmark_Float_BinCDF_10000000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_10000000[i%len(bincdfTestCases_10000000)]
		bincdfResultFlt = bincdf_(tc.n, tc.p, tc.x)
	}

	bincdfResultFlt++
}

func TestFixed_BinCDF_10000000(t *testing.T) {
	acc := accuracy{Epsilon: 1e-4}
	for i, tc := range bincdfTestCases_10000000 {
		p := From(tc.p)
		got := BinCDF(tc.n, p, tc.x)
		if ok := acc.update(got, tc.cdf); !ok {
			t.Errorf("%d: BinCDF(%v,%v,%v) => got %v|%v, want %v|%v", i, tc.n, tc.p, tc.x, got, got.Float(), From(tc.cdf), tc.cdf)
		}
	}
	t.Log(acc)
}
