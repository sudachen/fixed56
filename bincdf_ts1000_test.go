package fixed56

import "testing"

var bincdfTestCases_1000 = []BinCDFCase{
	{
		n:   754,
		x:   89,
		p:   0.10500215104453339,
		cdf: 0.8887530273670204,
		s:   "+0'e3855182c32918/56",
	},
	{
		n:   754,
		x:   517,
		p:   0.44897837076069524,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   754,
		x:   286,
		p:   0.5472942428328025,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   754,
		x:   675,
		p:   0.5481335489335352,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   754,
		x:   610,
		p:   0.7173877665258833,
		cdf: 0.9999999975367552,
		s:   "+0'fffffff56ba238/56",
	},
	{
		n:   532,
		x:   55,
		p:   0.10595944388761408,
		cdf: 0.4584722342298877,
		s:   "+0'755e6fb4243410/56",
	},
	{
		n:   532,
		x:   377,
		p:   0.446532178678148,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   532,
		x:   331,
		p:   0.4053071939367727,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   532,
		x:   404,
		p:   0.5432039225844807,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   532,
		x:   435,
		p:   0.8089882961206434,
		cdf: 0.7111220355636001,
		s:   "+0'b60c17fe35eaa0/56",
	},
	{
		n:   325,
		x:   60,
		p:   0.21785313677518178,
		cdf: 0.08117026630439166,
		s:   "+0'14c793172f5a63/56",
	},
	{
		n:   325,
		x:   163,
		p:   0.5517614734259535,
		cdf: 0.03905661569657144,
		s:   "+0'09ff9d471bf57d/56",
	},
	{
		n:   325,
		x:   128,
		p:   0.5396278789976454,
		cdf: 9.249123040232615e-08,
		s:   "+0'0000018d3f2eec/56",
	},
	{
		n:   325,
		x:   259,
		p:   0.45557426833432835,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   325,
		x:   280,
		p:   0.8914426144413563,
		cdf: 0.05376775222320337,
		s:   "+0'0dc3b93160ca7d/56",
	},
	{
		n:   444,
		x:   50,
		p:   0.11854916867602958,
		cdf: 0.383406513520377,
		s:   "+0'6226ede4a4b5f0/56",
	},
	{
		n:   444,
		x:   246,
		p:   0.47179587609692575,
		cdf: 0.9997817640034836,
		s:   "+0'fff1b29b883b20/56",
	},
	{
		n:   444,
		x:   236,
		p:   0.5207452062733783,
		cdf: 0.6921281965836676,
		s:   "+0'b12f5040f76030/56",
	},
	{
		n:   444,
		x:   307,
		p:   0.5459463573387636,
		cdf: 0.999999999859765,
		s:   "+0'ffffffff65cf58/56",
	},
	{
		n:   444,
		x:   366,
		p:   0.7249652325706419,
		cdf: 0.9999996431496004,
		s:   "+0'fffffa0356d618/56",
	},
	{
		n:   487,
		x:   53,
		p:   0.21040812625464542,
		cdf: 2.437380593798228e-09,
		s:   "+0'0000000a77eda5/56",
	},
	{
		n:   487,
		x:   455,
		p:   0.5257279598988888,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   487,
		x:   254,
		p:   0.5154704290513524,
		cdf: 0.623159680560283,
		s:   "+0'9f876490313580/56",
	},
	{
		n:   487,
		x:   341,
		p:   0.40916487673113244,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   487,
		x:   425,
		p:   0.8546136681577384,
		cdf: 0.8855781320755046,
		s:   "+0'e2b53f9b512ae8/56",
	},
	{
		n:   181,
		x:   25,
		p:   0.273296733351054,
		cdf: 1.032174033410029e-05,
		s:   "+0'0000ad2b898427/56",
	},
	{
		n:   181,
		x:   138,
		p:   0.45559472062201845,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   181,
		x:   100,
		p:   0.5668220853281501,
		cdf: 0.375578235240181,
		s:   "+0'6025e52d722b3c/56",
	},
	{
		n:   181,
		x:   130,
		p:   0.47403619342337655,
		cdf: 0.9999999999919268,
		s:   "+0'fffffffff71f98/56",
	},
	{
		n:   181,
		x:   157,
		p:   0.8340350348755388,
		cdf: 0.9074218576116533,
		s:   "+0'e84ccc821e1c50/56",
	},
	{
		n:   818,
		x:   90,
		p:   0.22182620113339765,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   818,
		x:   496,
		p:   0.5068279754059416,
		cdf: 0.9999999956092147,
		s:   "+0'ffffffed2447d0/56",
	},
	{
		n:   818,
		x:   397,
		p:   0.4326804987523857,
		cdf: 0.998907824698059,
		s:   "+0'ffb86c56cbf238/56",
	},
	{
		n:   818,
		x:   738,
		p:   0.45398956535685564,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   818,
		x:   656,
		p:   0.8376323916866627,
		cdf: 0.003934852196219164,
		s:   "+0'0101dfdd7f52a9/56",
	},
	{
		n:   324,
		x:   52,
		p:   0.26857038403796196,
		cdf: 2.7232571484051636e-06,
		s:   "+0'00002db04ce66c/56",
	},
	{
		n:   324,
		x:   176,
		p:   0.44580961439282085,
		cdf: 0.99982163351991,
		s:   "+0'fff44f81cd22b8/56",
	},
	{
		n:   324,
		x:   112,
		p:   0.561009160154243,
		cdf: 5.030754654407391e-15,
		s:   "+0'0000000000016a/56",
	},
	{
		n:   324,
		x:   267,
		p:   0.45354817519514057,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   324,
		x:   279,
		p:   0.8826272248371091,
		cdf: 0.13292369728091502,
		s:   "+0'22074994af57d8/56",
	},
	{
		n:   680,
		x:   108,
		p:   0.14252530881082812,
		cdf: 0.8967534690527951,
		s:   "+0'e591a2a6280378/56",
	},
	{
		n:   680,
		x:   595,
		p:   0.47912638021213294,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   680,
		x:   390,
		p:   0.49177037051747974,
		cdf: 0.9999917839001509,
		s:   "+0'ffff76281eae50/56",
	},
	{
		n:   680,
		x:   519,
		p:   0.42792606390510124,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   680,
		x:   544,
		p:   0.7525483217045871,
		cdf: 0.9985325977608352,
		s:   "+0'ff9fd5135f69f0/56",
	},
	{
		n:   698,
		x:   123,
		p:   0.2795645767204954,
		cdf: 1.3091685023479752e-10,
		s:   "+0'000000008ff1d1/56",
	},
	{
		n:   698,
		x:   553,
		p:   0.4723992887427222,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   698,
		x:   267,
		p:   0.5019052587352929,
		cdf: 1.5100138711069357e-10,
		s:   "+0'00000000a6071c/56",
	},
	{
		n:   698,
		x:   487,
		p:   0.5511564315067475,
		cdf: 0.9999999999999992,
		s:   "+0'ffffffffffffc8/56",
	},
	{
		n:   698,
		x:   615,
		p:   0.7305682638696522,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.1,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.1,
		cdf: 0.568199864325313,
		s:   "+0'91758bdade6d60/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.1,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.2,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.2,
		cdf: 0.5502799541387638,
		s:   "+0'8cdf25a6ab9d68/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.2,
		cdf: 0.9999999999999873,
		s:   "+0'fffffffffffc70/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.2,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.3,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.3,
		cdf: 8.577722324745499e-13,
		s:   "+0'0000000000f171/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.3,
		cdf: 0.5430230917289598,
		s:   "+0'8b038fb3f2dd60/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.3,
		cdf: 0.999999999995542,
		s:   "+0'fffffffffb1930/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.3,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.4,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.4,
		cdf: 4.9240242827595754e-11,
		s:   "+0'000000003623e5/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.4,
		cdf: 0.5394104755452154,
		s:   "+0'8a16ce0f962560/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.4,
		cdf: 0.9999999999559247,
		s:   "+0'ffffffffcf89e8/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.4,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.5,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.5,
		cdf: 2.0575849070690353e-10,
		s:   "+0'00000000e23bdd/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.5,
		cdf: 0.537787177929466,
		s:   "+0'89ac6ba56a49d8/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.5,
		cdf: 0.9999999999407572,
		s:   "+0'ffffffffbedca0/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.5,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.6,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.6,
		cdf: 1.5308289921730172e-10,
		s:   "+0'00000000a85101/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.6,
		cdf: 0.5377169426788004,
		s:   "+0'89a7d14b4f8080/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.6,
		cdf: 0.999999999987289,
		s:   "+0'fffffffff20628/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.6,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.7,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.7,
		cdf: 1.7270483908148395e-11,
		s:   "+0'0000000012fd35/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.7,
		cdf: 0.5394092281935766,
		s:   "+0'8a16b9224083e8/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.7,
		cdf: 0.9999999999998346,
		s:   "+0'ffffffffffd170/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.7,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.8,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.8,
		cdf: 6.56598799637776e-14,
		s:   "+0'0000000000127b/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.8,
		cdf: 0.5440999292828781,
		s:   "+0'8b4a220a069fb0/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.8,
		cdf: 0.9999999999999999,
		s:   "+0'fffffffffffff8/56",
	},
	{
		n:   1000,
		x:   1,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   101,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   201,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   301,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   401,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   501,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   601,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   701,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   801,
		p:   0.9,
		cdf: 0,
		s:   "+0'00000000000000/56",
	},
	{
		n:   1000,
		x:   901,
		p:   0.9,
		cdf: 0.5573878669188894,
		s:   "+0'8eb0f8a39a94a0/56",
	},
}

func Benchmark_Fixed_BinCDF_1000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_1000[i%len(bincdfTestCases_1000)]
		bincdfResultFix = BinCDF(tc.n, From(tc.p), tc.x)
	}

	bincdfResultFix.lo++
}

func Benchmark_Float_BinCDF_1000(b *testing.B) {
	for i := 0; i < b.N; i++ {
		tc := bincdfTestCases_1000[i%len(bincdfTestCases_1000)]
		bincdfResultFlt = bincdf_(tc.n, tc.p, tc.x)
	}

	bincdfResultFlt++
}

func TestFixed_BinCDF_1000(t *testing.T) {
	acc := accuracy{Epsilon: 1e-12}
	for i, tc := range bincdfTestCases_1000 {
		p := From(tc.p)
		got := BinCDF(tc.n, p, tc.x)
		if ok := acc.update(got, tc.cdf); !ok {
			t.Errorf("%d: BinCDF(%v,%v,%v) => got %v|%v, want %v|%v", i, tc.n, tc.p, tc.x, got, got.Float(), From(tc.cdf), tc.cdf)
		}
	}
	t.Log(acc)
}
